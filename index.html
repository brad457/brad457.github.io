<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Brad457.GitHub.io Directory Page</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
    * {
    margin: 0;
    padding: 0;
    font-family: Arial, Helvetica, sans-serif;
    }
    body {
    padding: 20px;
    }
    .directory {
    display: block;
    }
    .gallery {
    display: flex;
    flex-wrap: wrap;
    margin-top: 20px;
    }
    .img {
    width: 10vw;
    height: 10vw;
    margin: 10px;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    }
    </style>
  </head>
  <body>
    <div><table>
      <script  type="module">
      // formatBytes function to format the file size integer
      // Source: https://stackoverflow.com/questions/15900485/correct-way-to-convert-size-in-bytes-to-kb-mb-gb-in-javascript/18650828#18650828
      function formatBytes(a,b=2){if(0===a)return"0 Bytes";const c=0>b?0:b,d=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,d)).toFixed(c))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][d]}
      // GitHub Pages Dynamic Directory Listing  - BEGIN
      // Source: https://geolytix.github.io/MapIcons/
      import {render, html} from 'https://unpkg.com/uhtml?module';
      // OnLoas make GitHub API request for directory listing
      window.onload = async () => {
      //  const pathname = window.location.pathname.replace(/\/MapIcons/, '');
      // pathname
      const pathname = window.location.pathname
      //  const response = await fetch(`https://api.github.com/repos/geolytix/mapicons/contents${pathname}`)
      // request directory listing using GitHub API
      const response = await fetch(`https://api.github.com/repos/brad457/brad457.github.io/contents${pathname}`)
      // get directory listing request results
      const results = await response.json()
      // Output results of directories to page
      render(document.body, html`
      <tr><td>Object Type</td><td>Object Name</td><td>Size</td></tr>
      ${results.filter(el => el.type === 'dir').map(el => html`
      <a
        class="directory"
        href="${`https://brad457.github.io/${pathname}${el.name}`}"><tr><td><img src="folder.png" alt="${el.name}" /></td><td>${el.name}</a></td><td></td></tr>`)}
        `)
        // Output results of files to page
        render(document.body, html`
        <tr><td>Object Type</td><td>Object Name</td><td>Size</td></tr>
        ${results.filter(el => el.type === 'file').map(el => html`
        <a
          class="file"
          href="${`https://brad457.github.io/${pathname}${el.name}`}"><tr><td><img src="file.png" alt="${el.name}" /></td><td>${el.name}</a></td><td>${el.size}</td></tr>`)}
          `)
          // Test if GitHub Pages request returned results
          //document.write(results);
          }
          </script>
        </table>
      </div>
    </body>
  </html>
